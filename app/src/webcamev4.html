<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>DangerDec</title>
    <link rel="stylesheet" href="style.css">
    
    <title>Webcam Stream</title>
    <script>
        function startWebcam() {
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(stream => {
                    document.getElementById('webcam').srcObject = stream;
                })
                .catch(err => {
                    console.error("Error accessing webcam:", err);
                });
        }

        function captureFrame() {
            let video = document.getElementById('webcam');
            let canvas = document.createElement('canvas');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            let ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0);

            // Call function to download the image
            downloadImage(canvas);
        }

        function downloadImage(canvas) {
            let image = canvas.toDataURL("image/jpeg").replace("image/jpeg", "image/octet-stream");
            let link = document.createElement('a');
            link.download = 'captured-frame.jpeg';
            link.href = image;
            link.click();
        }

        function activateRedBorder() {
            document.getElementById('webcam').style.borderColor = 'red';
        }

        function deactivateRedBorder() {
            document.getElementById('webcam').style.borderColor = 'grey';
        }

        let isFlashing = false;
        let flashingInterval;

        function toggleFlashingBorder() {
            if (!isFlashing) {
                flashingInterval = setInterval(() => {
                    let videoElement = document.getElementById('webcam');
                    videoElement.style.borderColor = videoElement.style.borderColor === 'red' ? 'grey' : 'red';
                }, 200); // Adjust the interval as needed
            isFlashing = true;
            } else {
                clearInterval(flashingInterval);
                document.getElementById('webcam').style.borderColor = 'grey';
                isFlashing = false;
            }
        }

        function togglePoliceLights() {
            var policeLights = document.getElementById('police-lights');
            if (policeLights.style.display === 'none' || policeLights.style.display === '') {
                policeLights.style.display = 'block';
            } else {
                policeLights.style.display = 'none';
            }
        }   

        window.onload = function() {
            startWebcam();
            togglePoliceLights(); // Optionally toggle off the lights on load
        };

        

        if (true) {
            toggleFlashingBorder();
            togglePoliceLights9();
        }

        window.onload = startWebcam;

    function toggleFreezeFrame() {
        let video = document.getElementById('webcam');
        if (!video.paused) {
            video.pause();
        } else {
            video.play();
        }
    }


</script>


    </script>
    
</head>
<body>

    <h1>DangerDet</h1>
    <button onclick="togglePoliceLights()">Toggle Police Lights</button>
    <div id="police-lights">
        <div class="light red-light"></div>
        <div class="light blue-light"></div>
    </div>
    
    <video id="webcam" autoplay playsinline></video>
    <div class="button-container">
        <button class="screenshot_button" onclick="captureFrame()">Capture Frame</button>
        <button class="freeze_button" onclick="toggleFreezeFrame()">Freeze Frame</button>
    </div>
    

</body>
</html>